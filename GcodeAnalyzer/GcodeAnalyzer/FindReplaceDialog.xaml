<Window x:Class="GcodeAnalyzer.FindReplaceDialog"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        mc:Ignorable="d"
        Title="Find and Replace" Height="480" Width="550" 
        WindowStartupLocation="CenterOwner"
        ResizeMode="CanResize"
        Background="#FF1E1E1E"
        ShowInTaskbar="False"
        Topmost="False">
    
    <Window.Resources>
        <SolidColorBrush x:Key="BackgroundBrush" Color="#FF1E1E1E"/>
        <SolidColorBrush x:Key="SurfaceBrush" Color="#FF2D2D30"/>
        <SolidColorBrush x:Key="BorderBrush" Color="#FF3F3F46"/>
        <SolidColorBrush x:Key="ForegroundBrush" Color="#FFE0E0E0"/>
        <SolidColorBrush x:Key="ForegroundDimBrush" Color="#FF9E9E9E"/>
        <SolidColorBrush x:Key="AccentBrush" Color="#FF007ACC"/>
        
        <Style TargetType="Label">
            <Setter Property="Foreground" Value="{StaticResource ForegroundBrush}"/>
        </Style>
        
        <Style TargetType="TextBox">
            <Setter Property="Background" Value="{StaticResource SurfaceBrush}"/>
            <Setter Property="Foreground" Value="{StaticResource ForegroundBrush}"/>
            <Setter Property="BorderBrush" Value="{StaticResource BorderBrush}"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="Padding" Value="5"/>
            <Setter Property="CaretBrush" Value="White"/>
        </Style>
        
        <Style TargetType="CheckBox">
            <Setter Property="Foreground" Value="{StaticResource ForegroundBrush}"/>
        </Style>
        
        <Style TargetType="Button">
            <Setter Property="Background" Value="{StaticResource AccentBrush}"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Padding" Value="15,8"/>
            <Setter Property="MinWidth" Value="100"/>
            <Setter Property="Cursor" Value="Hand"/>
        </Style>
        
        <Style TargetType="GroupBox">
            <Setter Property="Foreground" Value="{StaticResource ForegroundBrush}"/>
            <Setter Property="BorderBrush" Value="{StaticResource BorderBrush}"/>
        </Style>
    </Window.Resources>
    
    <Grid Margin="15">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>
        
        <!-- Find Text -->
        <Grid Grid.Row="0" Margin="0,0,0,10">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>
            
            <Label Content="Find:" Grid.Column="0" VerticalAlignment="Center" Margin="0,0,10,0"/>
            <TextBox x:Name="TxtFind" Grid.Column="1" FontSize="14" 
                     KeyDown="TxtFind_KeyDown"/>
        </Grid>
        
        <!-- Replace Text -->
        <Grid Grid.Row="1" Margin="0,0,0,10">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>
            
            <Label Content="Replace:" Grid.Column="0" VerticalAlignment="Center" Margin="0,0,10,0"/>
            <TextBox x:Name="TxtReplace" Grid.Column="1" FontSize="14"
                     KeyDown="TxtReplace_KeyDown"/>
        </Grid>
        
        <!-- Options -->
        <GroupBox Grid.Row="2" Header="Options" Padding="10" Margin="0,0,0,10">
            <StackPanel>
                <CheckBox x:Name="ChkMatchCase" Content="Match case" Margin="0,5"/>
                <CheckBox x:Name="ChkWholeWord" Content="Match whole word only" Margin="0,5"/>
                <CheckBox x:Name="ChkUseRegex" Content="Use regular expressions" Margin="0,5"/>
                <CheckBox x:Name="ChkWrapAround" Content="Wrap around" IsChecked="True" Margin="0,5"/>
            </StackPanel>
        </GroupBox>
        
        <!-- Replace Scope -->
        <GroupBox Grid.Row="3" Header="Replace Scope" Padding="10" Margin="0,0,0,10">
            <StackPanel>
                <RadioButton x:Name="RbReplaceOnce" Content="Replace next occurrence" 
                             IsChecked="True" Margin="0,5" 
                             Foreground="{StaticResource ForegroundBrush}"/>
                <RadioButton x:Name="RbReplaceSelection" Content="Replace in selection" 
                             Margin="0,5"
                             Foreground="{StaticResource ForegroundBrush}"/>
                <RadioButton x:Name="RbReplaceAll" Content="Replace all in document" 
                             Margin="0,5"
                             Foreground="{StaticResource ForegroundBrush}"/>
            </StackPanel>
        </GroupBox>
        
        <!-- Buttons -->
        <Grid Grid.Row="4" Margin="0,5,0,10">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="Auto"/>
            </Grid.ColumnDefinitions>
            
            <Button x:Name="BtnFindNext" Content="Find Next" Grid.Column="1" 
                    Click="BtnFindNext_Click" Margin="0,0,5,0"/>
            <Button x:Name="BtnFindPrevious" Content="Find Previous" Grid.Column="2" 
                    Click="BtnFindPrevious_Click" Margin="0,0,5,0"/>
            <Button x:Name="BtnReplace" Content="Replace" Grid.Column="3" 
                    Click="BtnReplace_Click" Margin="0,0,5,0"
                    Background="#FF4CAF50"/>
            <Button x:Name="BtnClose" Content="Close" Grid.Column="4" 
                    Click="BtnClose_Click" Background="#FF607D8B"/>
        </Grid>
        
        <!-- Status/Info -->
        <Border Grid.Row="5" Background="{StaticResource SurfaceBrush}" 
                BorderBrush="{StaticResource BorderBrush}" BorderThickness="1"
                Padding="10" VerticalAlignment="Stretch">
            <TextBlock x:Name="TxtStatus" 
                       Foreground="{StaticResource ForegroundDimBrush}"
                       TextWrapping="Wrap"
                       VerticalAlignment="Top"
                       Text="Enter text to find and press Find Next or press Enter"/>
        </Border>
    </Grid>
    
    <!-- Keyboard shortcuts -->
    <Window.InputBindings>
        <KeyBinding Key="Escape" Command="{Binding CloseCommand, RelativeSource={RelativeSource AncestorType=Window}}"/>
        <KeyBinding Key="F3" Command="{Binding FindNextCommand, RelativeSource={RelativeSource AncestorType=Window}}"/>
        <KeyBinding Key="F3" Modifiers="Shift" Command="{Binding FindPreviousCommand, RelativeSource={RelativeSource AncestorType=Window}}"/>
    </Window.InputBindings>
</Window>

